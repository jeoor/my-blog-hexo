# Copilot instructions (my-blog-hexo)

## Project overview
- This repo is a **Hexo static blog** (Hexo `8.1.1`) with the **Butterfly** theme vendored at `themes/butterfly/` (see theme docs in `themes/butterfly/README.md`).
- Authoring happens in `source/` (Markdown posts in `source/_posts/`, pages in `source/**/index.md`); the generated site output is `public/`.

## Key structure & data flow
- Content: `source/_posts/*.md` using Hexo front-matter (see scaffold `scaffolds/post.md`).
- Site config: `_config.yml` (site URL/permalinks/theme selection) and theme override `_config.butterfly.yml` (preferred; `source/_data/butterfly.yml` is deprecated by theme init in `themes/butterfly/scripts/events/init.js`).
- Data files: `source/_data/*.yml` provide site data (e.g., `link.yml`, `shuoshuo.yml`) that theme pages read.
- Static assets under `source/` (e.g., `source/css/`, `source/js/`) are copied into `public/` on generate.
- Theme implementation (only touch when config/overrides can’t do it):
  - Templates: `themes/butterfly/layout/**/*.pug`
  - Styles: `themes/butterfly/source/css/**/*.styl`
  - Scripts: `themes/butterfly/source/js/**/*.js`

## Developer workflows (Windows / PowerShell)
- Install dependencies: `npm install` (or `npm ci` for lockfile-reproducible installs).
- Local preview: `npm run server` (runs `hexo server`).
- Generate static site: `npm run build` (runs `hexo generate`).
- Clean generated/cache artifacts: `npm run clean`.
- Deploy: `npm run deploy` (runs `hexo deploy`; requires `_config.yml: deploy:` to be configured).

## Project-specific conventions
- **Do not hand-edit `public/`**: it is generated by Hexo (`_config.yml: public_dir: public`). Make changes in `source/` / configs / theme source instead.
- Prefer customizing Butterfly via root `_config.butterfly.yml` rather than editing `themes/butterfly/_config.yml` directly.
- If theme config changes don’t take effect, ensure Hexo is loading the override config (Hexo commonly supports multi-config via `--config _config.yml,_config.butterfly.yml`). Prefer updating npm scripts over patching generated output.
- Renderers already included: `hexo-renderer-pug` and `hexo-renderer-stylus` (see `package.json`); avoid removing them since Butterfly relies on Pug/Stylus templates.
- There are **no automated tests**; validate by running `npm run server` and checking rendered pages.

## Dependency notes
- Theme requires Hexo >= 5.3.0 (enforced by `themes/butterfly/scripts/events/init.js`).
- This repo contains both `package-lock.json` and `yarn.lock`; avoid changing both in one PR—prefer the package manager already used for the change.

## How to make common changes
- Add/edit a post: edit `source/_posts/*.md` (follow front-matter from `scaffolds/post.md`).
- Change site URL/permalink/theme: edit `_config.yml`.
- Change theme appearance/features (nav/code blocks/cover/etc): edit `_config.butterfly.yml`.
- Only if necessary, adjust theme rendering: modify `themes/butterfly/layout/` (Pug) and `themes/butterfly/source/` (Stylus/JS), then regenerate.
